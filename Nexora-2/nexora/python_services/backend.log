INFO:     Started server process [28000]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)
✅ Supabase client initialized successfully
📊 Connected to: https://eecbqzvcnwrkcxgwjxlt.supabase.co
🔧 Initializing Supabase database tables...
✅ Users table already exists
✅ Invoices table already exists
ℹ️ insurance_policies table not found yet (run insurance_policies_schema.sql if you need Insurance Hub)
ℹ️ insurance_templates table not found yet (run insurance_policies_schema.sql if you need Insurance Hub)
ℹ️ business_risk_assessments table not found yet (run insurance_policies_schema.sql if you need Insurance Hub)
ℹ️ policy_reminders table not found yet (run insurance_policies_schema.sql if you need Insurance Hub)
✅ Database initialization completed!
🚀 Starting Nexora Credit Score API with Supabase Database...
✅ Supabase client initialized successfully
📊 Connected to: https://eecbqzvcnwrkcxgwjxlt.supabase.co
🔧 Initializing Supabase database tables...
✅ Users table already exists
✅ Invoices table already exists
ℹ️ insurance_policies table not found yet (run insurance_policies_schema.sql if you need Insurance Hub)
ℹ️ insurance_templates table not found yet (run insurance_policies_schema.sql if you need Insurance Hub)
ℹ️ business_risk_assessments table not found yet (run insurance_policies_schema.sql if you need Insurance Hub)
ℹ️ policy_reminders table not found yet (run insurance_policies_schema.sql if you need Insurance Hub)
✅ Database initialization completed!
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54188 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54190 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54206 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54208 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
INFO:     127.0.0.1:54212 - "POST /insurance/assess HTTP/1.1" 403 Forbidden
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54229 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54231 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54243 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54245 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54254 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54256 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54262 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54264 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54268 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54270 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54294 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54296 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
INFO:     127.0.0.1:54314 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:54314 - "OPTIONS /calculate-credit-score HTTP/1.1" 200 OK
📊 Calculating credit score...
INFO:     127.0.0.1:54315 - "OPTIONS / HTTP/1.1" 200 OK
INFO:     127.0.0.1:54316 - "OPTIONS / HTTP/1.1" 200 OK
INFO:     127.0.0.1:54315 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:54316 - "GET / HTTP/1.1" 200 OK
📋 Fetching invoices for user: 4
✅ Retrieved 1 invoices from Supabase
INFO:     127.0.0.1:54315 - "GET /user/invoices HTTP/1.1" 200 OK
📋 Fetching invoices for user: 4
✅ Retrieved 1 invoices from Supabase
INFO:     127.0.0.1:54316 - "GET /user/invoices HTTP/1.1" 200 OK
📋 Fetching invoices for user: 4
✅ Retrieved 1 invoices from Supabase
INFO:     127.0.0.1:54315 - "GET /user/invoices HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54317 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54318 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📋 Fetching invoices for user: 4
✅ Retrieved 1 invoices from Supabase
INFO:     127.0.0.1:54319 - "GET /user/invoices HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54316 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54315 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
```
{
  "final_weighted_credit_score": 73.5,
  "score_category": "Good",
  "factor_breakdown": {
    "payment_completion_rate": {
      "actual_value": 0.7,
      "individual_score": 70,
      "weighted_score": 28,
      "weight_percentage": 40,
      "comment": "Payment completion rate is good, indicating a consistent effort to settle invoices."
    },
    "paid_to_pending_ratio": {
      "actual_value": 2.33,
      "individual_score": 80,
      "weighted_score": 24,
      "weight_percentage": 30,
      "comment": "The paid-to-pending ratio is good, suggesting efficient management of pending amounts."
    },
    "tax_compliance": {
      "actual_value": 0.1,
      "individual_score": 90,
      "weighted_score": 13.5,
      "weight_percentage": 15,
      "comment": "Tax compliance is excellent, with a low tax percentage of total amount."
    },
    "extra_charges_management": {
      "actual_value": 0.02,
      "individual_score": 80,
      "weighted_score": 12,
      "weight_percentage": 15,
      "comment": "Extra charges management is good, with a low extra charges percentage of total amount."
    }
  },
  "detailed_analysis": {
    "strengths": ["Stable payment completion rate", "Efficient paid-to-pending ratio", "Good tax compliance"],
    "weaknesses": ["Room for improvement in payment completion rate", "Pending amounts still significant"],
    "risk_assessment": "Medium risk",
    "creditworthiness_summary": [
      "Cash inflow appears stable enough to cover 70% of monthly invoices, but pending amounts remain significant at 30%.",
      "The paid-to-pending ratio of 2.33 suggests that incoming revenue is being efficiently used to clear outstanding dues.",
      "Extra charges, while moderate, could be optimized by improving operational efficiency and avoiding late fees or penalties.",
      "Overall financial health is good, but attention to payment completion rate and pending amount management will be crucial for sustained creditworthiness."
    ]
  },
  "recommendations": {
    "immediate_actions": ["Review and optimize payment completion rate", "Analyze and address pending amounts"],
    "long_term_improvements": ["Implement efficient cash flow management systems", "Continuously monitor and improve tax compliance and extra charges management"],
    "priority_focus_areas": ["Payment completion rate", "Pending amount management", "Tax compliance and extra charges optimization"]
  }
}
```
✅ Credit score calculated
INFO:     127.0.0.1:54314 - "POST /calculate-credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54338 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54340 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54351 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54353 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54362 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54364 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54389 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54390 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54412 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
📊 Fetching dashboard credit score for user: 4
✅ Dashboard credit score calculated from Supabase: 54.0 (Poor)
INFO:     127.0.0.1:54412 - "GET /dashboard/credit-score HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [28000]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [23888]
